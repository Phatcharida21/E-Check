<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
        .exam-day {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            font-weight: bold;
            position: relative;
        }
        .exam-day::after {
            content: 'üìù';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
        }
        .today {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            font-weight: bold;
        }
        .calendar-day {
            transition: all 0.2s ease;
        }
        .calendar-day:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .tab-active {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }
        .tab-inactive {
            background: #f3f4f6;
            color: #6b7280;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-4 text-center">üéì ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö</h1>
            
            <!-- ‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏°‡∏ô‡∏π -->
            <div class="flex justify-center space-x-4">
                <button onclick="showTab('table')" id="tableTab" class="tab-active px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-md">
                    üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö
                </button>
                <button onclick="showTab('calendar')" id="calendarTab" class="tab-inactive px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                    üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏™‡∏≠‡∏ö
                </button>
            </div>
        </div>

        <!-- ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 1: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö -->
        <div id="tableView" class="tab-content">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏•‡∏∞ Export -->
                <div class="mb-6 flex flex-wrap gap-3">
                    <button onclick="showAddForm()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 shadow-md">
                        ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤
                    </button>
                    <button onclick="exportToExcel()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 shadow-md">
                        üìä Export Excel
                    </button>
                    <button onclick="exportToWord()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 shadow-md">
                        üìÑ Export Word
                    </button>
                </div>

                <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ -->
                <div id="addForm" class="hidden bg-gray-50 p-6 rounded-lg mb-6 border-2 border-dashed border-gray-300">
                    <h3 class="text-xl font-semibold mb-4 text-gray-700">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
                    
                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <input type="text" id="courseCode" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô CP353001)" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="text" id="courseName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent md:col-span-2">
                        <input type="text" id="courseGroup" placeholder="‡∏Å‡∏•‡∏∏‡πà‡∏°" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>

                    <!-- ‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ -->
                    <div class="bg-blue-50 p-4 rounded-lg mb-4">
                        <h4 class="font-semibold text-blue-800 mb-3">üìù ‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</h4>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <input type="date" id="midtermDate" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="time" id="midtermStartTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="time" id="midtermEndTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" id="midtermRoom" placeholder="‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <!-- ‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ -->
                    <div class="bg-red-50 p-4 rounded-lg mb-4">
                        <h4 class="font-semibold text-red-800 mb-3">üìù ‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</h4>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                            <input type="date" id="finalDate" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="time" id="finalStartTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="time" id="finalEndTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <input type="text" id="finalRoom" placeholder="‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <div class="flex gap-3">
                        <button onclick="addCourse()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200">
                            ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°
                        </button>
                        <button onclick="hideAddForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200">
                            ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </div>

                <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse bg-white rounded-lg overflow-hidden shadow-sm">
                        <thead class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white">
                            <tr>
                                <th rowspan="2" class="border border-gray-300 px-4 py-3 text-left font-semibold align-middle">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤</th>
                                <th rowspan="2" class="border border-gray-300 px-4 py-3 text-left font-semibold align-middle">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</th>
                                <th rowspan="2" class="border border-gray-300 px-4 py-3 text-center font-semibold align-middle">‡∏Å‡∏•‡∏∏‡πà‡∏°</th>
                                <th colspan="3" class="border border-gray-300 px-4 py-2 text-center font-semibold">‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</th>
                                <th colspan="3" class="border border-gray-300 px-4 py-2 text-center font-semibold">‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</th>
                                <th rowspan="2" class="border border-gray-300 px-4 py-3 text-center font-semibold align-middle">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th rowspan="2" class="border border-gray-300 px-4 py-3 text-center font-semibold align-middle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                            <tr>
                                <th class="border border-gray-300 px-3 py-2 text-center font-medium text-sm">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th class="border border-gray-300 px-3 py-2 text-center font-medium text-sm">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th class="border border-gray-300 px-3 py-2 text-center font-medium text-sm">‡∏´‡πâ‡∏≠‡∏á</th>
                                <th class="border border-gray-300 px-3 py-2 text-center font-medium text-sm">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th class="border border-gray-300 px-3 py-2 text-center font-medium text-sm">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th class="border border-gray-300 px-3 py-2 text-center font-medium text-sm">‡∏´‡πâ‡∏≠‡∏á</th>
                            </tr>
                        </thead>
                        <tbody id="courseTable">
                            <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 2: ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏™‡∏≠‡∏ö -->
        <div id="calendarView" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex justify-between items-center mb-6">
                            <button onclick="previousMonth()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors duration-200">
                                ‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô
                            </button>
                            <h2 class="text-2xl font-bold text-gray-800" id="monthYear">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2568</h2>
                            <button onclick="nextMonth()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors duration-200">
                                ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí
                            </button>
                        </div>

                        <!-- ‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå -->
                        <div class="grid grid-cols-7 gap-2 mb-4">
                            <div class="text-center font-semibold text-red-600 py-2">‡∏≠‡∏≤</div>
                            <div class="text-center font-semibold text-gray-700 py-2">‡∏à</div>
                            <div class="text-center font-semibold text-gray-700 py-2">‡∏≠</div>
                            <div class="text-center font-semibold text-gray-700 py-2">‡∏û</div>
                            <div class="text-center font-semibold text-gray-700 py-2">‡∏û‡∏§</div>
                            <div class="text-center font-semibold text-gray-700 py-2">‡∏®</div>
                            <div class="text-center font-semibold text-blue-600 py-2">‡∏™</div>
                        </div>

                        <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
                        <div class="grid grid-cols-7 gap-2" id="calendarDays">
                            <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìù ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
                        <div id="examList" class="space-y-4">
                            <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                        </div>
                    </div>

                    <!-- ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö -->
                    <div class="bg-white rounded-xl shadow-lg p-6 mt-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                                <span class="font-bold text-blue-600" id="totalSubjects">7</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö:</span>
                                <span class="font-bold text-red-600" id="examSubjects">5</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö:</span>
                                <span class="font-bold text-orange-600" id="examDays">5</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö:</span>
                                <span class="font-bold text-green-600" id="noExamSubjects">2</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
            <div id="examDetails" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4" id="selectedDate">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</h3>
                <div id="examDetailsContent">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
                
                <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå -->
                <div id="weeklySchedule" class="mt-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse bg-white rounded-lg overflow-hidden shadow-sm">
                            <thead class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white">
                                <tr>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡∏û‡∏∏‡∏ò</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡∏®‡∏∏‡∏Å‡∏£‡πå</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">‡πÄ‡∏™‡∏≤‡∏£‡πå</th>
                                </tr>
                                <tr class="bg-indigo-400">
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm font-medium">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</td>
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm" id="weekDate0"></td>
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm" id="weekDate1"></td>
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm" id="weekDate2"></td>
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm" id="weekDate3"></td>
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm" id="weekDate4"></td>
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm" id="weekDate5"></td>
                                    <td class="border border-gray-300 px-3 py-1 text-center text-sm" id="weekDate6"></td>
                                </tr>
                            </thead>
                            <tbody id="weeklyScheduleBody">
                                <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
        <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 w-full max-w-4xl mx-4 max-h-screen overflow-y-auto">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</h3>
                
                <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <input type="text" id="editCourseCode" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <input type="text" id="editCourseName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent md:col-span-2">
                    <input type="text" id="editCourseGroup" placeholder="‡∏Å‡∏•‡∏∏‡πà‡∏°" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>

                <!-- ‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ -->
                <div class="bg-blue-50 p-4 rounded-lg mb-4">
                    <h4 class="font-semibold text-blue-800 mb-3">üìù ‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</h4>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                        <input type="date" id="editMidtermDate" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="time" id="editMidtermStartTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="time" id="editMidtermEndTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="text" id="editMidtermRoom" placeholder="‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>

                <!-- ‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ -->
                <div class="bg-red-50 p-4 rounded-lg mb-4">
                    <h4 class="font-semibold text-red-800 mb-3">üìù ‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</h4>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                        <input type="date" id="editFinalDate" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="time" id="editFinalStartTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="time" id="editFinalEndTime" placeholder="‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="text" id="editFinalRoom" placeholder="‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>

                <div class="flex gap-3 justify-end">
                    <button onclick="saveEdit()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                    </button>
                    <button onclick="closeEditModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200">
                        ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤
        let courses = [
            {
                id: 1,
                code: "CP353001",
                name: "Operating Systems and System Calls Programming\n‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏≠‡∏•",
                group: "4",
                midterm: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                },
                final: {
                    date: "2024-10-28",
                    startTime: "08:30",
                    endTime: "11:30",
                    room: "N/A"
                }
            },
            {
                id: 2,
                code: "CP353002",
                name: "Principles of Software Design and Development\n‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå",
                group: "4",
                midterm: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                },
                final: {
                    date: "2024-10-25",
                    startTime: "13:00",
                    endTime: "16:00",
                    room: "N/A"
                }
            },
            {
                id: 3,
                code: "CP353003",
                name: "Artificial Intelligence\n‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå",
                group: "2",
                midterm: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                },
                final: {
                    date: "2024-10-30",
                    startTime: "08:30",
                    endTime: "11:30",
                    room: "N/A"
                }
            },
            {
                id: 4,
                code: "CP353201",
                name: "Software Quality Assurance\n‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå",
                group: "2",
                midterm: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                },
                final: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                }
            },
            {
                id: 5,
                code: "CP353761",
                name: "Seminar in Computer Science\n‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå",
                group: "2",
                midterm: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                },
                final: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                }
            },
            {
                id: 6,
                code: "GE362785",
                name: "CREATIVE THINKING AND PROBLEM SOLVING\n‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤",
                group: "17",
                midterm: {
                    date: "",
                    startTime: "",
                    endTime: "",
                    room: ""
                },
                final: {
                    date: "2024-10-26",
                    startTime: "13:00",
                    endTime: "16:00",
                    room: "N/A"
                }
            },
            {
                id: 7,
                code: "SC403602",
                name: "NUMERICAL METHODS FOR COMPUTER SCIENCE\n‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ä‡∏¥‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå",
                group: "2",
                midterm: {
                    date: "2024-08-28",
                    startTime: "08:30",
                    endTime: "11:30",
                    room: "N/A"
                },
                final: {
                    date: "2024-10-24",
                    startTime: "13:00",
                    endTime: "16:00",
                    room: "N/A"
                }
            }
        ];

        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
        const examData = {
            '24': [
                {
                    code: 'SC403602',
                    name: '‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ä‡∏¥‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
                    time: '13:00-16:00',
                    type: '‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ',
                    room: 'N/A'
                }
            ],
            '25': [
                {
                    code: 'CP353002',
                    name: '‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå',
                    time: '13:00-16:00',
                    type: '‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ',
                    room: 'N/A'
                }
            ],
            '26': [
                {
                    code: 'GE362785',
                    name: '‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤',
                    time: '13:00-16:00',
                    type: '‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ',
                    room: 'N/A'
                }
            ],
            '28': [
                {
                    code: 'CP353001',
                    name: '‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ã‡∏µ‡∏™‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏≠‡∏•',
                    time: '08:30-11:30',
                    type: '‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ',
                    room: 'N/A'
                }
            ],
            '30': [
                {
                    code: 'CP353003',
                    name: '‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå',
                    time: '08:30-11:30',
                    type: '‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ',
                    room: 'N/A'
                }
            ]
        };

        let editingId = null;
        let currentMonth = 9; // ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° (0-based)
        let currentYear = 2568;
        const today = new Date();
        const todayDate = today.getDate();
        const todayMonth = today.getMonth();
        const todayYear = today.getFullYear() + 543; // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡∏û.‡∏®.

        const monthNames = [
            '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
            '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
        ];

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ó‡πá‡∏ö
        function showTab(tabName) {
            // ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡πÅ‡∏ó‡πá‡∏ö
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });

            // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ó‡πá‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            if (tabName === 'table') {
                document.getElementById('tableView').classList.remove('hidden');
                document.getElementById('tableTab').className = 'tab-active px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-md';
                document.getElementById('calendarTab').className = 'tab-inactive px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg';
            } else if (tabName === 'calendar') {
                document.getElementById('calendarView').classList.remove('hidden');
                document.getElementById('calendarTab').className = 'tab-active px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-md';
                document.getElementById('tableTab').className = 'tab-inactive px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg';
                generateCalendar();
                generateExamList();
                updateStats();
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 1)
        function renderTable() {
            const tbody = document.getElementById('courseTable');
            tbody.innerHTML = '';

            courses.forEach(course => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 transition-colors duration-150';
                
                const status = getExamStatus(course);
                const statusBadge = getStatusBadge(status);
                const midtermDisplay = formatExamDisplay(course.midterm);
                const finalDisplay = formatExamDisplay(course.final);

                const midtermDate = course.midterm.date ? new Date(course.midterm.date).toLocaleDateString('th-TH', { day: 'numeric', month: 'short' }) : '-';
                const midtermTime = (course.midterm.startTime && course.midterm.endTime) ? `${course.midterm.startTime}-${course.midterm.endTime}` : '-';
                const midtermRoom = course.midterm.room || '-';
                
                const finalDate = course.final.date ? new Date(course.final.date).toLocaleDateString('th-TH', { day: 'numeric', month: 'short' }) : '-';
                const finalTime = (course.final.startTime && course.final.endTime) ? `${course.final.startTime}-${course.final.endTime}` : '-';
                const finalRoom = course.final.room || '-';

                row.innerHTML = `
                    <td class="border border-gray-300 px-4 py-3 font-medium text-blue-700">${course.code}</td>
                    <td class="border border-gray-300 px-4 py-3">
                        <div class="whitespace-pre-line text-sm">${course.name}</div>
                    </td>
                    <td class="border border-gray-300 px-4 py-3 text-center font-medium">${course.group}</td>
                    <td class="border border-gray-300 px-3 py-3 text-center">
                        <div class="text-sm ${midtermDate === '-' ? 'text-gray-400' : 'text-gray-700'}">${midtermDate}</div>
                    </td>
                    <td class="border border-gray-300 px-3 py-3 text-center">
                        <div class="text-sm ${midtermTime === '-' ? 'text-gray-400' : 'text-gray-700'}">${midtermTime}</div>
                    </td>
                    <td class="border border-gray-300 px-3 py-3 text-center">
                        <div class="text-sm ${midtermRoom === '-' ? 'text-gray-400' : 'text-gray-700'}">${midtermRoom}</div>
                    </td>
                    <td class="border border-gray-300 px-3 py-3 text-center">
                        <div class="text-sm ${finalDate === '-' ? 'text-gray-400' : 'text-gray-700'}">${finalDate}</div>
                    </td>
                    <td class="border border-gray-300 px-3 py-3 text-center">
                        <div class="text-sm ${finalTime === '-' ? 'text-gray-400' : 'text-gray-700'}">${finalTime}</div>
                    </td>
                    <td class="border border-gray-300 px-3 py-3 text-center">
                        <div class="text-sm ${finalRoom === '-' ? 'text-gray-400' : 'text-gray-700'}">${finalRoom}</div>
                    </td>
                    <td class="border border-gray-300 px-4 py-3 text-center">${statusBadge}</td>
                    <td class="border border-gray-300 px-4 py-3 text-center">
                        <div class="flex gap-2 justify-center">
                            <button onclick="editCourse(${course.id})" class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-sm font-medium transition-colors duration-200">
                                ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                            </button>
                            <button onclick="deleteCourse(${course.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm font-medium transition-colors duration-200">
                                üóëÔ∏è ‡∏•‡∏ö
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function formatExamDisplay(examData) {
            if (!examData.date || !examData.startTime || !examData.endTime) {
                return '-';
            }
            
            const date = new Date(examData.date);
            const thaiDate = date.toLocaleDateString('th-TH', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
            
            return `${thaiDate}<br>‡πÄ‡∏ß‡∏•‡∏≤ ${examData.startTime}-${examData.endTime}<br>‡∏´‡πâ‡∏≠‡∏á: ${examData.room || 'N/A'}`;
        }

        function getExamStatus(course) {
            const hasMidterm = course.midterm.date && course.midterm.startTime && course.midterm.endTime;
            const hasFinal = course.final.date && course.final.startTime && course.final.endTime;
            
            if (!hasMidterm && !hasFinal) return 'no-exam';
            if (hasMidterm && hasFinal) return 'both-exams';
            if (hasFinal) return 'final-only';
            return 'midterm-only';
        }

        function getStatusBadge(status) {
            switch(status) {
                case 'no-exam':
                    return '<span class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-sm font-medium">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö</span>';
                case 'both-exams':
                    return '<span class="bg-red-100 text-red-700 px-3 py-1 rounded-full text-sm font-medium">‡∏°‡∏µ‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà</span>';
                case 'final-only':
                    return '<span class="bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-sm font-medium">‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>';
                case 'midterm-only':
                    return '<span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium">‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>';
                default:
                    return '<span class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-sm font-medium">-</span>';
            }
        }

        function showAddForm() {
            document.getElementById('addForm').classList.remove('hidden');
        }

        function hideAddForm() {
            document.getElementById('addForm').classList.add('hidden');
            clearAddForm();
        }

        function clearAddForm() {
            document.getElementById('courseCode').value = '';
            document.getElementById('courseName').value = '';
            document.getElementById('courseGroup').value = '';
            document.getElementById('midtermDate').value = '';
            document.getElementById('midtermStartTime').value = '';
            document.getElementById('midtermEndTime').value = '';
            document.getElementById('midtermRoom').value = '';
            document.getElementById('finalDate').value = '';
            document.getElementById('finalStartTime').value = '';
            document.getElementById('finalEndTime').value = '';
            document.getElementById('finalRoom').value = '';
        }

        function addCourse() {
            const code = document.getElementById('courseCode').value.trim();
            const name = document.getElementById('courseName').value.trim();
            const group = document.getElementById('courseGroup').value.trim();
            
            const midtermDate = document.getElementById('midtermDate').value;
            const midtermStartTime = document.getElementById('midtermStartTime').value;
            const midtermEndTime = document.getElementById('midtermEndTime').value;
            const midtermRoom = document.getElementById('midtermRoom').value.trim();
            
            const finalDate = document.getElementById('finalDate').value;
            const finalStartTime = document.getElementById('finalStartTime').value;
            const finalEndTime = document.getElementById('finalEndTime').value;
            const finalRoom = document.getElementById('finalRoom').value.trim();

            if (!code || !name || !group) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°');
                return;
            }

            const newId = Math.max(...courses.map(c => c.id), 0) + 1;
            courses.push({
                id: newId,
                code: code,
                name: name,
                group: group,
                midterm: {
                    date: midtermDate,
                    startTime: midtermStartTime,
                    endTime: midtermEndTime,
                    room: midtermRoom
                },
                final: {
                    date: finalDate,
                    startTime: finalStartTime,
                    endTime: finalEndTime,
                    room: finalRoom
                }
            });

            renderTable();
            hideAddForm();
        }

        function editCourse(id) {
            const course = courses.find(c => c.id === id);
            if (!course) return;

            editingId = id;
            document.getElementById('editCourseCode').value = course.code;
            document.getElementById('editCourseName').value = course.name;
            document.getElementById('editCourseGroup').value = course.group;
            
            document.getElementById('editMidtermDate').value = course.midterm.date || '';
            document.getElementById('editMidtermStartTime').value = course.midterm.startTime || '';
            document.getElementById('editMidtermEndTime').value = course.midterm.endTime || '';
            document.getElementById('editMidtermRoom').value = course.midterm.room || '';
            
            document.getElementById('editFinalDate').value = course.final.date || '';
            document.getElementById('editFinalStartTime').value = course.final.startTime || '';
            document.getElementById('editFinalEndTime').value = course.final.endTime || '';
            document.getElementById('editFinalRoom').value = course.final.room || '';
            
            document.getElementById('editModal').classList.remove('hidden');
        }

        function saveEdit() {
            if (!editingId) return;

            const code = document.getElementById('editCourseCode').value.trim();
            const name = document.getElementById('editCourseName').value.trim();
            const group = document.getElementById('editCourseGroup').value.trim();
            
            const midtermDate = document.getElementById('editMidtermDate').value;
            const midtermStartTime = document.getElementById('editMidtermStartTime').value;
            const midtermEndTime = document.getElementById('editMidtermEndTime').value;
            const midtermRoom = document.getElementById('editMidtermRoom').value.trim();
            
            const finalDate = document.getElementById('editFinalDate').value;
            const finalStartTime = document.getElementById('editFinalStartTime').value;
            const finalEndTime = document.getElementById('editFinalEndTime').value;
            const finalRoom = document.getElementById('editFinalRoom').value.trim();

            if (!code || !name || !group) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°');
                return;
            }

            const courseIndex = courses.findIndex(c => c.id === editingId);
            if (courseIndex !== -1) {
                courses[courseIndex] = {
                    ...courses[courseIndex],
                    code: code,
                    name: name,
                    group: group,
                    midterm: {
                        date: midtermDate,
                        startTime: midtermStartTime,
                        endTime: midtermEndTime,
                        room: midtermRoom
                    },
                    final: {
                        date: finalDate,
                        startTime: finalStartTime,
                        endTime: finalEndTime,
                        room: finalRoom
                    }
                };
            }

            renderTable();
            closeEditModal();
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
            editingId = null;
        }

        function deleteCourse(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ô‡∏µ‡πâ?')) {
                courses = courses.filter(c => c.id !== id);
                renderTable();
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 2)
        function generateCalendar() {
            const calendarDays = document.getElementById('calendarDays');
            const monthYear = document.getElementById('monthYear');
            
            monthYear.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
            const firstDay = new Date(currentYear - 543, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear - 543, currentMonth + 1, 0).getDate();
            
            calendarDays.innerHTML = '';
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'h-12';
                calendarDays.appendChild(emptyDay);
            }
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'h-16 flex items-center justify-center rounded-lg cursor-pointer calendar-day';
                dayElement.textContent = day;
                
                // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (day === todayDate && currentMonth === todayMonth && currentYear === todayYear) {
                    dayElement.classList.add('today');
                }
                
                // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏™‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (examData[day.toString()]) {
                    dayElement.classList.add('exam-day');
                    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠
                    const examInfo = examData[day.toString()];
                    if (examInfo.length > 0) {
                        const shortName = examInfo[0].code.substring(0, 8) + (examInfo.length > 1 ? `+${examInfo.length-1}` : '');
                        dayElement.innerHTML = `
                            <div class="text-center">
                                <div class="font-bold">${day}</div>
                                <div class="text-xs mt-1 opacity-90">${shortName}</div>
                            </div>
                        `;
                    }
                }
                
                if (!dayElement.classList.contains('today') && !dayElement.classList.contains('exam-day')) {
                    dayElement.className += ' bg-gray-50 hover:bg-gray-100 text-gray-700';
                }
                
                dayElement.addEventListener('click', () => showExamDetails(day));
                calendarDays.appendChild(dayElement);
            }
        }

        function showExamDetails(day) {
            const examDetails = document.getElementById('examDetails');
            const selectedDate = document.getElementById('selectedDate');
            const examDetailsContent = document.getElementById('examDetailsContent');
            
            selectedDate.textContent = `‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö - ${day} ${monthNames[currentMonth]} ${currentYear}`;
            
            if (examData[day.toString()]) {
                const exams = examData[day.toString()];
                let content = '';
                
                exams.forEach(exam => {
                    content += `
                        <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded-r-lg">
                            <div class="flex items-start">
                                <div class="flex-shrink-0">
                                    <span class="text-2xl">üìù</span>
                                </div>
                                <div class="ml-3 flex-1">
                                    <h4 class="text-lg font-semibold text-red-800">${exam.code}</h4>
                                    <p class="text-red-700 mb-2">${exam.name}</p>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 text-sm">
                                        <div><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ${exam.type}</div>
                                        <div><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${exam.time}</div>
                                        <div><strong>‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö:</strong> ${exam.room}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                examDetailsContent.innerHTML = content;
            } else {
                examDetailsContent.innerHTML = `
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg text-center">
                        <span class="text-4xl">üéâ</span>
                        <p class="text-green-700 mt-2 font-medium">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                        <p class="text-green-600 text-sm">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!</p>
                    </div>
                `;
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
            generateWeeklySchedule(day);
            
            examDetails.classList.remove('hidden');
            examDetails.scrollIntoView({ behavior: 'smooth' });
        }

        function generateWeeklySchedule(selectedDay) {
            // ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const selectedDate = new Date(currentYear - 543, currentMonth, selectedDay);
            const dayOfWeek = selectedDate.getDay(); // 0 = ‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå, 1 = ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå, ...
            const startOfWeek = new Date(selectedDate);
            startOfWeek.setDate(selectedDate.getDate() - dayOfWeek);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            for (let i = 0; i < 7; i++) {
                const currentDate = new Date(startOfWeek);
                currentDate.setDate(startOfWeek.getDate() + i);
                const dateElement = document.getElementById(`weekDate${i}`);
                dateElement.textContent = currentDate.getDate();
                
                // ‡πÄ‡∏ô‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                if (currentDate.getDate() === selectedDay && currentDate.getMonth() === currentMonth) {
                    dateElement.className = 'border border-gray-300 px-3 py-1 text-center text-sm bg-yellow-200 font-bold';
                } else {
                    dateElement.className = 'border border-gray-300 px-3 py-1 text-center text-sm';
                }
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤
            const scheduleBody = document.getElementById('weeklyScheduleBody');
            const timeSlots = [
                '08:00-09:00', '09:00-10:00', '10:00-11:00', '11:00-12:00',
                '12:00-13:00', '13:00-14:00', '14:00-15:00', '15:00-16:00',
                '16:00-17:00', '17:00-18:00', '18:00-19:00', '19:00-20:00'
            ];
            
            let scheduleHTML = '';
            
            timeSlots.forEach(timeSlot => {
                scheduleHTML += `<tr class="hover:bg-gray-50">`;
                scheduleHTML += `<td class="border border-gray-300 px-3 py-2 text-center font-medium bg-gray-50">${timeSlot}</td>`;
                
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
                for (let dayIndex = 0; dayIndex < 7; dayIndex++) {
                    const currentDate = new Date(startOfWeek);
                    currentDate.setDate(startOfWeek.getDate() + dayIndex);
                    const dayNumber = currentDate.getDate();
                    
                    let cellContent = '';
                    let cellClass = 'border border-gray-300 px-2 py-2 text-center text-xs';
                    
                    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏™‡∏≠‡∏ö‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    if (examData[dayNumber.toString()]) {
                        const exams = examData[dayNumber.toString()];
                        exams.forEach(exam => {
                            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≠‡∏ö‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                            const [startTime, endTime] = exam.time.split('-');
                            const slotStart = timeSlot.split('-')[0];
                            const slotEnd = timeSlot.split('-')[1];
                            
                            if (isTimeInRange(startTime, endTime, slotStart, slotEnd)) {
                                cellContent = `
                                    <div class="bg-red-100 border border-red-300 rounded p-1">
                                        <div class="font-semibold text-red-800 text-xs">${exam.code}</div>
                                        <div class="text-red-600 text-xs">${exam.type}</div>
                                        <div class="text-red-500 text-xs">${exam.room}</div>
                                    </div>
                                `;
                                cellClass += ' bg-red-50';
                            }
                        });
                    }
                    
                    // ‡πÄ‡∏ô‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                    if (dayNumber === selectedDay && currentDate.getMonth() === currentMonth) {
                        cellClass += ' bg-yellow-50 border-yellow-300';
                    }
                    
                    scheduleHTML += `<td class="${cellClass}">${cellContent}</td>`;
                }
                
                scheduleHTML += `</tr>`;
            });
            
            scheduleBody.innerHTML = scheduleHTML;
        }

        function isTimeInRange(examStart, examEnd, slotStart, slotEnd) {
            // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏≤‡∏ó‡∏µ
            const examStartMinutes = timeToMinutes(examStart);
            const examEndMinutes = timeToMinutes(examEnd);
            const slotStartMinutes = timeToMinutes(slotStart);
            const slotEndMinutes = timeToMinutes(slotEnd);
            
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            return (examStartMinutes < slotEndMinutes && examEndMinutes > slotStartMinutes);
        }

        function timeToMinutes(timeString) {
            const [hours, minutes] = timeString.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function generateExamList() {
            const examList = document.getElementById('examList');
            let content = '';
            
            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
            const allExams = [];
            Object.keys(examData).forEach(day => {
                examData[day].forEach(exam => {
                    allExams.push({
                        ...exam,
                        day: parseInt(day)
                    });
                });
            });
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
            allExams.sort((a, b) => a.day - b.day);
            
            allExams.forEach(exam => {
                const dayName = new Date(currentYear - 543, currentMonth, exam.day).toLocaleDateString('th-TH', { weekday: 'long' });
                content += `
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <div class="flex items-center mb-2">
                                    <span class="bg-red-500 text-white px-2 py-1 rounded text-sm font-medium mr-2">
                                        ${exam.day} ‡∏ï.‡∏Ñ.
                                    </span>
                                    <span class="text-gray-600 text-sm">${dayName}</span>
                                </div>
                                <h4 class="font-semibold text-gray-800 mb-1">${exam.code}</h4>
                                <p class="text-gray-600 text-sm mb-2">${exam.name}</p>
                                <div class="flex items-center text-sm text-gray-500">
                                    <span class="mr-4">‚è∞ ${exam.time}</span>
                                    <span>üè¢ ${exam.room}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            examList.innerHTML = content;
        }

        function previousMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateCalendar();
            generateExamList();
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateCalendar();
            generateExamList();
        }

        function updateStats() {
            const totalSubjects = courses.length;
            const examSubjects = courses.filter(course => 
                (course.midterm.date && course.midterm.startTime && course.midterm.endTime) || 
                (course.final.date && course.final.startTime && course.final.endTime)
            ).length;
            const examDays = Object.keys(examData).length;
            const noExamSubjects = totalSubjects - examSubjects;
            
            document.getElementById('totalSubjects').textContent = totalSubjects;
            document.getElementById('examSubjects').textContent = examSubjects;
            document.getElementById('examDays').textContent = examDays;
            document.getElementById('noExamSubjects').textContent = noExamSubjects;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Export ‡πÑ‡∏ü‡∏•‡πå
        function exportToExcel() {
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV
            let csvContent = '\uFEFF'; // BOM ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö UTF-8
            csvContent += '‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤,‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤,‡∏Å‡∏•‡∏∏‡πà‡∏°,‡∏ß‡∏±‡∏ô‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ,‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ,‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ,‡∏ß‡∏±‡∏ô‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ,‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ,‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\n';
            
            courses.forEach(course => {
                const midtermDate = course.midterm.date ? new Date(course.midterm.date).toLocaleDateString('th-TH') : '-';
                const midtermTime = (course.midterm.startTime && course.midterm.endTime) ? `${course.midterm.startTime}-${course.midterm.endTime}` : '-';
                const midtermRoom = course.midterm.room || '-';
                
                const finalDate = course.final.date ? new Date(course.final.date).toLocaleDateString('th-TH') : '-';
                const finalTime = (course.final.startTime && course.final.endTime) ? `${course.final.startTime}-${course.final.endTime}` : '-';
                const finalRoom = course.final.room || '-';
                
                const status = getExamStatusText(getExamStatus(course));
                
                // ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
                const cleanName = course.name.replace(/\n/g, ' ');
                
                csvContent += `"${course.code}","${cleanName}","${course.group}","${midtermDate}","${midtermTime}","${midtermRoom}","${finalDate}","${finalTime}","${finalRoom}","${status}"\n`;
            });
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö_${new Date().toLocaleDateString('th-TH')}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            showNotification('üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        function exportToWord() {
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Word
            let htmlContent = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö</title>
                    <style>
                        body { font-family: 'TH Sarabun New', Arial, sans-serif; font-size: 14pt; }
                        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
                        th, td { border: 1px solid #000; padding: 8px; text-align: left; }
                        th { background-color: #4472C4; color: white; font-weight: bold; text-align: center; }
                        .center { text-align: center; }
                        .header { text-align: center; font-size: 18pt; font-weight: bold; margin-bottom: 20px; }
                        .status-no-exam { background-color: #f3f4f6; color: #6b7280; }
                        .status-both-exams { background-color: #fef2f2; color: #dc2626; }
                        .status-final-only { background-color: #fff7ed; color: #ea580c; }
                        .status-midterm-only { background-color: #eff6ff; color: #2563eb; }
                    </style>
                </head>
                <body>
                    <div class="header">üéì ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö</div>
                    <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:</strong> ${new Date().toLocaleDateString('th-TH', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        weekday: 'long'
                    })}</p>
                    <table>
                        <thead>
                            <tr>
                                <th rowspan="2">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤</th>
                                <th rowspan="2">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</th>
                                <th rowspan="2">‡∏Å‡∏•‡∏∏‡πà‡∏°</th>
                                <th colspan="3">‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</th>
                                <th colspan="3">‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</th>
                                <th rowspan="2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            </tr>
                            <tr>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th>‡∏´‡πâ‡∏≠‡∏á</th>
                                <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th>‡∏´‡πâ‡∏≠‡∏á</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            courses.forEach(course => {
                const midtermDate = course.midterm.date ? new Date(course.midterm.date).toLocaleDateString('th-TH', { day: 'numeric', month: 'short', year: 'numeric' }) : '-';
                const midtermTime = (course.midterm.startTime && course.midterm.endTime) ? `${course.midterm.startTime}-${course.midterm.endTime}` : '-';
                const midtermRoom = course.midterm.room || '-';
                
                const finalDate = course.final.date ? new Date(course.final.date).toLocaleDateString('th-TH', { day: 'numeric', month: 'short', year: 'numeric' }) : '-';
                const finalTime = (course.final.startTime && course.final.endTime) ? `${course.final.startTime}-${course.final.endTime}` : '-';
                const finalRoom = course.final.room || '-';
                
                const status = getExamStatus(course);
                const statusText = getExamStatusText(status);
                const statusClass = `status-${status.replace('-', '-')}`;
                
                htmlContent += `
                    <tr>
                        <td class="center"><strong>${course.code}</strong></td>
                        <td>${course.name.replace(/\n/g, '<br>')}</td>
                        <td class="center">${course.group}</td>
                        <td class="center">${midtermDate}</td>
                        <td class="center">${midtermTime}</td>
                        <td class="center">${midtermRoom}</td>
                        <td class="center">${finalDate}</td>
                        <td class="center">${finalTime}</td>
                        <td class="center">${finalRoom}</td>
                        <td class="center ${statusClass}">${statusText}</td>
                    </tr>
                `;
            });
            
            htmlContent += `
                        </tbody>
                    </table>
                    <div style="margin-top: 30px;">
                        <h3>üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</h3>
                        <ul>
                            <li><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</strong> ${courses.length} ‡∏ß‡∏¥‡∏ä‡∏≤</li>
                            <li><strong>‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö:</strong> ${courses.filter(course => 
                                (course.midterm.date && course.midterm.startTime && course.midterm.endTime) || 
                                (course.final.date && course.final.startTime && course.final.endTime)
                            ).length} ‡∏ß‡∏¥‡∏ä‡∏≤</li>
                            <li><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö:</strong> ${Object.keys(examData).length} ‡∏ß‡∏±‡∏ô</li>
                            <li><strong>‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö:</strong> ${courses.length - courses.filter(course => 
                                (course.midterm.date && course.midterm.startTime && course.midterm.endTime) || 
                                (course.final.date && course.final.startTime && course.final.endTime)
                            ).length} ‡∏ß‡∏¥‡∏ä‡∏≤</li>
                        </ul>
                    </div>
                </body>
                </html>
            `;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
            const blob = new Blob([htmlContent], { type: 'application/msword;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö_${new Date().toLocaleDateString('th-TH')}.doc`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            showNotification('üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Word ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }

        function formatExamDisplayForWord(examData) {
            if (!examData.date || !examData.startTime || !examData.endTime) {
                return '-';
            }
            
            const date = new Date(examData.date);
            const thaiDate = date.toLocaleDateString('th-TH', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
            
            return `${thaiDate}<br>‡πÄ‡∏ß‡∏•‡∏≤ ${examData.startTime}-${examData.endTime}<br>‡∏´‡πâ‡∏≠‡∏á: ${examData.room || 'N/A'}`;
        }

        function getExamStatusText(status) {
            switch(status) {
                case 'no-exam':
                    return '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏≠‡∏ö';
                case 'both-exams':
                    return '‡∏°‡∏µ‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà';
                case 'final-only':
                    return '‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô';
                case 'midterm-only':
                    return '‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô';
                default:
                    return '-';
            }
        }

        function showNotification(message, type = 'info') {
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á notification element
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transition-all duration-300 transform translate-x-full`;
            
            if (type === 'success') {
                notification.className += ' bg-green-500 text-white';
            } else if (type === 'error') {
                notification.className += ' bg-red-500 text-white';
            } else {
                notification.className += ' bg-blue-500 text-white';
            }
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <span class="mr-2">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-white hover:text-gray-200">
                        ‚úï
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // ‡πÅ‡∏™‡∏î‡∏á notification
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // ‡∏ã‡πà‡∏≠‡∏ô notification ‡∏´‡∏•‡∏±‡∏á 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, 300);
            }, 3000);
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        renderTable();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96c62c0304ab799a',t:'MTc1NDczMTE2Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
